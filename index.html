<script>
document.getElementById("form-tarea").addEventListener("submit", async function(e) {
  e.preventDefault();

  // Obtener valores
  const tarea = document.getElementById("tarea").value.trim();
  const proyecto = document.getElementById("proyecto").value.trim();
  const fecha_vencimiento = document.getElementById("fecha_vencimiento").value;
  const prioridad = document.getElementById("prioridad").value;
  const responsable = document.getElementById("responsable").value.trim();

  // Validación mínima
  if (!tarea || !prioridad) {
    alert("Tarea y prioridad son obligatorias");
    return;
  }

  try {
    const response = await fetch("https://camiloperez.app.n8n.cloud/webhook/agente-tareas", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        tarea,
        proyecto,
        fecha_vencimiento,
        prioridad,
        origen: "Formulario",
        responsable
      })
    });

    const data = await response.json();

    if (response.ok) {
      alert("Tarea enviada correctamente");
      document.getElementById("form-tarea").reset();
      console.log("Respuesta:", data);
    } else {
      alert("Error al enviar la tarea");
      console.error(data);
    }

  } catch (error) {
    alert("Error de conexión");
    console.error("Error:", error);
  }
});
</script>

